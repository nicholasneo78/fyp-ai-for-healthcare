I [22/m] and a friend of mine [20/m] had a dispute which questions our friendship.
TL;DR, 
OP misread the situation by telling a joke to which his drunk friend took offence and revealed to OP's other friends OPs 3-year buried drug habit. OPs friends now know things OP originally wanted to be left in the past. 
 

*********


My friend (let's call him T, for now) and I had a dispute over what we classify as exposing each other. T was very drunk and gave some information I kept very personal out to my other friends and myself who were sober at the time. He mentioned the last time I got high, but he did mention how long ago. This is important because Ive had an on and off history of depression which I've been struggling with years, and I previously I used to combat it by developing a drug habit. I've been working hard to be clean for 3 years, and I've kept all this under the rug because I didn't wish to be labelled by my friends as irresponsible, or be denied respect as their friend. I buried my past and drug habits for good,  doing so brought me great happiness because this was the first thing I felt I like I myself was worth something and it let me come out of depression for a long time. He did all this because I had made a joke in this particular conversation, to which he reacted negatively, and said I ruined his reputation though my joke was not intentional to do so. Because of this, people I trust  now are asking me if I do drugs or partake in self harm because of what he said about me. Some people I'm friends with are asking me if I need counselling though I'm clean. I'm not sure if I can forgive him and it's made me feel less than a person, which is something I haven't felt in 3 years. I feel worthless again and I'm not quite sure I can mend all my friendships that probably think down upon lowest point in life. Should I cut ties with T? What should I do if now my other friends  might not see me the same way anymore?